<!DOCTYPE html>
<html lang="en">
<head>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Rubik:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/cap.css">
    <link rel="stylesheet" href="../css/header.css">
    <link rel="stylesheet" href="../css/recipe-full.css">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <div class="header">
        <div class="header__inner">
            <div class="header__logo">
                <a href="index.html"><img src="../images/logo.jpg" alt=""></a>
            </div>
            <div class="header__nav">
                <ul>
                    <li><a href="">Сложность</a></li>
                    <li><a href="all-recipe">Все рецепты</a></li>
                    <li><a href="">Тип</a></li>
                </ul>
            </div>
            <div class="header__links-list">
                <div class="header__link">
                    <img src="../images/person.png" alt="">
                </div>
                <div class="header__link">
                    <img src="../images/sunny.png" alt="">
                </div>
            </div>
        </div>
</div>

<div class="main">
    <div class="container">
        <div class="main__inner">
            <div class="recipe">
                <div class="recipe__name">
                    <p>Брауни</p>
                </div>
                <div class="recipe__info">
                    <div class="recipe__portion">
                        <img src="../images/eat.png" alt="">
                        <p>6</p>
                    </div>
                    <div class="recipe__time">
                        <img src="../images/time.png" alt="">
                        <p>40 минут</p>
                    </div>
                </div>
                <div class="recipe__photos">
                    <div class="recipe__main-photo">
                        <img src="../images/brauni/brauni.jpg" alt="">
                    </div>
                    <div class="recipe__galary">
                        <!--<div class="recipe__galary-item">
                            <img src="../images/brauni/1.jpg" alt="">
                        </div>
                        <div class="recipe__galary-item">
                            <img src="../images/brauni/2.jpg" alt="">
                        </div>
                        <div class="recipe__galary-item">
                            <img src="../images/brauni/3.jpg" alt="">
                        </div>-->
                    </div>
                </div>
                <div class="recipe__description">
                    <p>Один из самых популярных десертов в мире — брауни — был придуман в 1893 году на кухне легендарного отеля Palmer House в Чикаго. Этот пирог там пекут до сих пор по оригинальному рецепту, покрывая сверху абрикосовой глазурью. В домашней версии, впрочем, у брауни получается такая изумительная сахарная корочка, что глазировать ее было бы преступлением. У традиционных шоколадных брауни ванильный аромат, хрустящая корочка и влажная серединка. В торт также добавляют грецкие орехи или фисташки, а еще клюкву.</p>
                </div>
                <div class="recipe__energy-list">
                    <div class="recipe__energy">
                        <div class="energy__head">КАЛОРИЙНОСТЬ</div>
                        <div class="energy__amount">676</div>
                        <div class="energy__desc">ККАЛ</div>
                    </div>
                    <div class="recipe__energy">
                        <div class="energy__head">БЕЛКИ</div>
                        <div class="energy__amount">10</div>
                        <div class="energy__desc">ГРАММ</div>
                    </div>
                    <div class="recipe__energy">
                        <div class="energy__head">ЖИРЫ</div>
                        <div class="energy__amount">46</div>
                        <div class="energy__desc">ГРАММ</div></div>
                    <div class="recipe__energy">
                        <div class="energy__head">УГЛЕВОДЫ</div>
                        <div class="energy__amount">55</div>
                        <div class="energy__desc">ГРАММ</div>
                    </div>
                </div>
                <div class="recipe__ingredient">
                    <div class="recipe__ingredient-head"><p>Ингредиенты</p></div>
                    <div class="recipe__ingredient-list">
                        <div class="ingredient">
                            <div class="ingredient__name">Темный шоколад</div>
                            <div class="ingredient__stroke"></div>
                            <div class="ingredient__amount">100 г</div>
                        </div>
                        <div class="ingredient">
                            <div class="ingredient__name">Темный шоколад</div>
                            <div class="ingredient__stroke"></div>
                            <div class="ingredient__amount">100 г</div>
                        </div>
                        <div class="ingredient">
                            <div class="ingredient__name">Темный шоколад</div>
                            <div class="ingredient__stroke"></div>
                            <div class="ingredient__amount">100 г</div>
                        </div>
                        <div class="ingredient">
                            <div class="ingredient__name">Темный шоколад</div>
                            <div class="ingredient__stroke"></div>
                            <div class="ingredient__amount">100 г</div>
                        </div>
                    </div>
                </div>
                <div class="recipe__steps">
                    <div class="recipe__steps-head">инструкция приготовления</div>
                    <div class="recipe__step-list">
                        <div class="step">
                            <div class="step__photo">
                                <img src="../images/brauni/steps/1.jpg" alt="">
                            </div>
                            <div class="step__description">Шоколад разломать на кусочки и вместе со сливочным маслом растопить на водяной бане, не переставая все время помешивать лопаткой или деревянной ложкой. Получившийся густой шоколадный соус снять с водяной бани и оставить остывать.</div>
                        </div>
                        <div class="step">
                            <div class="step__photo">
                                <img src="../images/brauni/steps/2.jpg" alt="">
                            </div>
                            <div class="step__description">Тем временем смешать яйца со ста граммами коричневого сахара: яйца разбить в отдельную миску и взбить, постепенно добавляя сахар. Взбивать можно при помощи миксера или вручную — как больше нравится, — но не меньше двух с половиной-трех минут.</div>
                        </div>
                    </div>
                </div>
                <div class="cap">
                    <img src="../images/cap.png" alt="">
                    <div class="cap-text">
                        <p>Я не придумал, что должно быть на главной странице,<br> так что смотрите на классную чашечку</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let path = window.location.href.split("/")
    let id = path[path.length - 1]
    let recipe
    (async function dode() {
        recipe = await getRecipe(id);
        console.log(recipe)
        pushRecipe(recipe)
    })();

    async function getRecipe(id) {
        const to_return_data = await fetch("/api/recipe/" + id, {
            method: "GET",
            headers: { "Accept": "application/json" }
        })
            .then(async (response) => {
                return response.json().then(theData => theData);
            })
        return to_return_data;
    };

    function pushRecipe(recipe) {
        let recipeName = document.querySelector(".recipe__name p")
        let recipePortion = document.querySelector(".recipe__portion p")
        let recipeDescription = document.querySelector(".recipe__description p")
        let recipeTime = document.querySelector(".recipe__time p")
        let recipePhoto = document.querySelector(".recipe__main-photo")
        let recipeGalary = document.querySelector(".recipe__galary")
        let recipeEnergies = document.querySelectorAll(".energy__amount")
        let recipeIngredients = document.querySelector(".recipe__ingredient-list")
        let recipeSteps = document.querySelector(".recipe__step-list")


        recipeName.innerText = recipe.name
        recipePortion.innerText = recipe.portion
        recipeTime.innerText = recipe.time
        recipePhoto.innerHTML = `<img src="../${recipe.imageUrl}" alt="">`
        recipeGalary.innerHTML = compileGalary(recipe.galaryPhotos)
        recipeDescription.innerText = recipe.description
        recipeEnergies[0].innerText = recipe.energyValue.calories
        recipeEnergies[1].innerText = recipe.energyValue.carbohydrates
        recipeEnergies[2].innerText = recipe.energyValue.fats
        recipeEnergies[3].innerText = recipe.energyValue.squirrels
        recipeIngredients.innerHTML = compileIngredients(recipe.ingredients)
        recipeSteps.innerHTML = compileSteps(recipe.steps)

    }

    function compileGalary(galaryItems) {
        let ret = ""
        for (let i = 0; i < galaryItems.length; i++) {
            ret = ret + `<div class="recipe__galary-item">
                            <img src="../${galaryItems[i]}" alt="">
                        </div>`
        }
        return ret
    }

    function compileIngredients(ingredients) {
        let ret = ""
        for (let i = 0; i < ingredients.length; i++) {
            ret = ret + `<div class="ingredient">
                            <div class="ingredient__name">${ingredients[i].name}</div>
                            <div class="ingredient__stroke"></div>
                            <div class="ingredient__amount">${ingredients[i].amount}</div>
                        </div>`
        }
        return ret
    }

    function compileSteps(steps) {
        let ret = ""
        for (let i = 0; i < steps.length; i++) {
            ret = ret + `<div class="step">
                            <div class="step__photo">
                                <img src="../${steps[i].imageUrl}" alt="">
                            </div>
                            <div class="step__description">${steps[i].description}</div>
                        </div>`
        }
        return ret
    }

</script>

</body>
</html>